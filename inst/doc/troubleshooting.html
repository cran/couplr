<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Gilles Colling" />

<meta name="date" content="2026-01-14" />

<title>Troubleshooting Guide</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Troubleshooting Guide</h1>
<h4 class="author">Gilles Colling</h4>
<h4 class="date">2026-01-14</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This vignette provides solutions to common issues encountered when
using couplr. Each section describes a problem, explains why it occurs,
and provides step-by-step solutions.</p>
<p><strong>Quick reference:</strong></p>
<table>
<colgroup>
<col width="29%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th>Issue</th>
<th>Jump to Section</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>No valid pairs found</td>
<td><a href="#infeasible-problems">Infeasible Problems</a></td>
</tr>
<tr class="even">
<td>Poor balance after matching</td>
<td><a href="#poor-balance-despite-matching">Poor Balance</a></td>
</tr>
<tr class="odd">
<td>Matching is too slow</td>
<td><a href="#performance-issues">Performance Issues</a></td>
</tr>
<tr class="even">
<td>Memory errors</td>
<td><a href="#memory-errors">Memory Errors</a></td>
</tr>
<tr class="odd">
<td>Different results with different methods</td>
<td><a href="#different-results-with-different-methods">Non-Determinism</a></td>
</tr>
<tr class="even">
<td>Unexpected NA in results</td>
<td><a href="#missing-values-in-data">Missing Values</a></td>
</tr>
<tr class="odd">
<td>C++ compilation errors</td>
<td><a href="#installation-issues">Installation Issues</a></td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="infeasible-problems" class="section level2">
<h2>Infeasible Problems</h2>
<div id="symptom" class="section level3">
<h3>Symptom</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># This fails: all assignments have Inf cost</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Error in `lap_solve_bruteforce()`:</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; ! Infeasible given forbidden edges</span></span></code></pre></div>
<p>Error message: “No feasible assignment found” or total cost is
Inf.</p>
</div>
<div id="cause" class="section level3">
<h3>Cause</h3>
<p>A feasible assignment requires that every row can be assigned to at
least one column with finite cost. When rows have all-Inf or all-NA
entries, no valid assignment exists.</p>
</div>
<div id="diagnosis" class="section level3">
<h3>Diagnosis</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Check for infeasible rows</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>check_feasibility <span class="ot">&lt;-</span> <span class="cf">function</span>(cost_matrix) {</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  finite_per_row <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">is.finite</span>(cost_matrix))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  infeasible_rows <span class="ot">&lt;-</span> <span class="fu">which</span>(finite_per_row <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(infeasible_rows) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Infeasible rows (no finite costs):&quot;</span>, infeasible_rows, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  }</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  finite_per_col <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.finite</span>(cost_matrix))</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  infeasible_cols <span class="ot">&lt;-</span> <span class="fu">which</span>(finite_per_col <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(infeasible_cols) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Infeasible columns (no finite costs):&quot;</span>, infeasible_cols, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  }</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Problem appears feasible</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>}</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co"># Check the problematic matrix</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="fu">check_feasibility</span>(cost)</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; Infeasible rows (no finite costs): 2</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
<div id="solutions" class="section level3">
<h3>Solutions</h3>
<p><strong>1. Remove infeasible rows/columns:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Remove rows with no valid assignments</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>valid_rows <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">is.finite</span>(cost)) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>cost_valid <span class="ot">&lt;-</span> cost[valid_rows, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(cost_valid) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost_valid)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Matched&quot;</span>, <span class="fu">nrow</span>(result), <span class="st">&quot;of&quot;</span>, <span class="fu">nrow</span>(cost), <span class="st">&quot;rows</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Matched 2 of 3 rows</span></span></code></pre></div>
<p><strong>2. Add fallback costs:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Replace Inf with high (but finite) penalty</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>cost_with_fallback <span class="ot">&lt;-</span> cost</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>cost_with_fallback[<span class="sc">!</span><span class="fu">is.finite</span>(cost_with_fallback)] <span class="ot">&lt;-</span> <span class="fl">1e6</span>  <span class="co"># Large penalty</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost_with_fallback)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; Assignment Result</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; =================</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;   source target    cost</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;  &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 1      1      1       1</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 2      2      3 1000000</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 3      3      2       2</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; Total cost: 1000003 </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; Method: bruteforce</span></span></code></pre></div>
<p><strong>3. For matching: check covariate overlap:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Simulate poor overlap scenario</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">3</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">55</span>, <span class="at">sd =</span> <span class="dv">3</span>))</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># Visualize overlap</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  left <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">&quot;Left&quot;</span>),</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  right <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">&quot;Right&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="fu">ggplot</span>(combined, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Poor Covariate Overlap&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;No overlap means no good matches possible&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span></code></pre></div>
<p><img role="img" aria-label="Density plot showing overlap between treatment and control groups on the age variable" src="data:image/png;base64,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" alt="Density plot showing overlap between treatment and control groups on the age variable" /></p>
<hr />
</div>
</div>
<div id="poor-balance-despite-matching" class="section level2">
<h2>Poor Balance Despite Matching</h2>
<div id="symptom-1" class="section level3">
<h3>Symptom</h3>
<p>After matching, <code>balance_diagnostics()</code> shows |std_diff|
&gt; 0.25 for some variables.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Example of poor balance</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">30</span>, <span class="dv">5</span>),</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">80000</span>, <span class="dv">20000</span>)  <span class="co"># Very different from right</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">32</span>, <span class="dv">5</span>),</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">40000</span>, <span class="dv">10000</span>)  <span class="co"># Very different income</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(left, right, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>), <span class="at">auto_scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; Auto-selected scaling method: standardize</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>balance <span class="ot">&lt;-</span> <span class="fu">balance_diagnostics</span>(result, left, right, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>))</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="fu">print</span>(balance)</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; Balance Diagnostics for Matched Pairs</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; ======================================</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; Matching Summary:</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt;   Method: lap</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt;   Matched pairs: 100</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt;   Unmatched left: 0 (of 100)</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt;   Unmatched right: 0 (of 100)</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; Variable-level Balance:</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt;   Variable `Mean Left` `Mean Right` `Mean Diff` `Std Diff` `Var Ratio` `KS Stat`</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; 1 age             30.6         32.5       -1.89     -0.386        1.05      0.22</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; 2 income       77666.       41353.     36313.        2.40         2.15      0.81</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; Overall Balance:</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt;   Mean |Std Diff|: 1.391 (Poor)</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt;   Max |Std Diff|: 2.397</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt;   Vars with |Std Diff| &gt; 0.25: 100.0%</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; Balance Interpretation:</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| &lt; 0.10: Excellent balance</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| 0.10-0.25: Good balance</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| 0.25-0.50: Acceptable balance</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| &gt; 0.50: Poor balance</span></span></code></pre></div>
</div>
<div id="causes" class="section level3">
<h3>Causes</h3>
<ol style="list-style-type: decimal">
<li><strong>Weak overlap</strong>: Groups are too different on key
variables</li>
<li><strong>Missing confounders</strong>: Important variables not
included in matching</li>
<li><strong>Caliper too loose</strong>: Accepting poor matches</li>
<li><strong>Wrong scaling</strong>: Variables not properly weighted</li>
</ol>
</div>
<div id="solutions-1" class="section level3">
<h3>Solutions</h3>
<p><strong>1. Add more matching variables:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Include additional relevant variables</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  left, right,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;region&quot;</span>),  <span class="co"># More variables</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">auto_scale =</span> <span class="cn">TRUE</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>2. Tighten caliper (fewer but better matches):</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>result_strict <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  left, right,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">max_distance =</span> <span class="fl">0.3</span>,  <span class="co"># Stricter caliper</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">auto_scale =</span> <span class="cn">TRUE</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Auto-selected scaling method: standardize</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Error in `lap_solve_auction_scaled()`:</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; ! Auction(scaled): iteration guard at eps=7885383213142811494408480082840444688844086424042268422604802684204020084804602286084062426808668246202024044680060000888826240426666820268808860060886662888880668826624624282408686624866884640486622460688806226620844868208208262004280626244240268286668462608648088464686088602226464888282882.000000, phase=19</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Original matches:&quot;</span>, result<span class="sc">$</span>info<span class="sc">$</span>n_matched, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Original matches: 100</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;With caliper:&quot;</span>, result_strict<span class="sc">$</span>info<span class="sc">$</span>n_matched, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; With caliper: 40</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>balance_strict <span class="ot">&lt;-</span> <span class="fu">balance_diagnostics</span>(result_strict, left, right, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="fu">print</span>(balance_strict)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; Balance Diagnostics for Matched Pairs</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; ======================================</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; Matching Summary:</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;   Method: lap</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;   Matched pairs: 40</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt;   Unmatched left: 0 (of 100)</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt;   Unmatched right: 60 (of 100)</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; Variable-level Balance:</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt;   Variable `Mean Left` `Mean Right` `Mean Diff` `Std Diff` `Var Ratio` `KS Stat`</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; 1 age             30.4         32.9       -2.52     -0.517        1.25     0.275</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; 2 income       75769.       41145.     34624.        2.42         2.41     0.825</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; Overall Balance:</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt;   Mean |Std Diff|: 1.468 (Poor)</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt;   Max |Std Diff|: 2.419</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt;   Vars with |Std Diff| &gt; 0.25: 100.0%</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt; Balance Interpretation:</span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| &lt; 0.10: Excellent balance</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| 0.10-0.25: Good balance</span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| 0.25-0.50: Acceptable balance</span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt;   |Std Diff| &gt; 0.50: Poor balance</span></span></code></pre></div>
<p><strong>3. Use blocking on problematic variable:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Block on income tertiles to ensure exact balance</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>left<span class="sc">$</span>income_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(left<span class="sc">$</span>income, <span class="at">breaks =</span> <span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>right<span class="sc">$</span>income_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(right<span class="sc">$</span>income, <span class="at">breaks =</span> <span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">matchmaker</span>(left, right, <span class="at">block_type =</span> <span class="st">&quot;group&quot;</span>, <span class="at">block_by =</span> <span class="st">&quot;income_cat&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>result_blocked <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  blocks<span class="sc">$</span>left, blocks<span class="sc">$</span>right,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>),  <span class="co"># Match on age within income blocks</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="at">block_id =</span> <span class="st">&quot;block_id&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>4. Try different scaling:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Compare scaling methods</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="cf">for</span> (scale_method <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;robust&quot;</span>, <span class="st">&quot;standardize&quot;</span>, <span class="st">&quot;range&quot;</span>)) {</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(left, right, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>),</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                       <span class="at">auto_scale =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> scale_method)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  bal <span class="ot">&lt;-</span> <span class="fu">balance_diagnostics</span>(res, left, right, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;income&quot;</span>))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="fu">cat</span>(scale_method, <span class="st">&quot;- max |std_diff|:&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>      <span class="fu">round</span>(bal<span class="sc">$</span>overall<span class="sc">$</span>max_abs_std_diff, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; robust - max |std_diff|: 2.397 </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; standardize - max |std_diff|: 2.397 </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; range - max |std_diff|: 2.397</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="performance-issues" class="section level2">
<h2>Performance Issues</h2>
<div id="symptom-2" class="section level3">
<h3>Symptom</h3>
<p><code>match_couples()</code> or <code>lap_solve()</code> takes too
long or doesn’t complete.</p>
</div>
<div id="cause-1" class="section level3">
<h3>Cause</h3>
<p>Optimal matching has <span class="math inline">\(O(n^3)\)</span>
complexity. For n = 5,000, this means ~125 billion operations.</p>
</div>
<div id="diagnosis-1" class="section level3">
<h3>Diagnosis</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Estimate runtime</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>estimate_runtime <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">seconds_per_billion =</span> <span class="dv">1</span>) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  ops <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  time_sec <span class="ot">&lt;-</span> ops <span class="sc">/</span> <span class="fl">1e9</span> <span class="sc">*</span> seconds_per_billion</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="cf">if</span> (time_sec <span class="sc">&lt;</span> <span class="dv">60</span>) {</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.1f seconds&quot;</span>, time_sec)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (time_sec <span class="sc">&lt;</span> <span class="dv">3600</span>) {</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.1f minutes&quot;</span>, time_sec <span class="sc">/</span> <span class="dv">60</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.1f hours&quot;</span>, time_sec <span class="sc">/</span> <span class="dv">3600</span>)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>}</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated runtime for optimal matching:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; Estimated runtime for optimal matching:</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">3000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>)) {</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;  n = %5d: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, n, <span class="fu">estimate_runtime</span>(n)))</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>}</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;   n =   100: 0.0 seconds</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;   n =   500: 0.1 seconds</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt;   n =  1000: 1.0 seconds</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt;   n =  3000: 27.0 seconds</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt;   n =  5000: 2.1 minutes</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt;   n = 10000: 16.7 minutes</span></span></code></pre></div>
</div>
<div id="solutions-2" class="section level3">
<h3>Solutions</h3>
<p><strong>1. Use greedy matching for large problems:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>large_left <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">x1 =</span> <span class="fu">rnorm</span>(n), <span class="at">x2 =</span> <span class="fu">rnorm</span>(n))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>large_right <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">x1 =</span> <span class="fu">rnorm</span>(n), <span class="at">x2 =</span> <span class="fu">rnorm</span>(n))</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># Greedy is much faster</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>time_greedy <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  result_greedy <span class="ot">&lt;-</span> <span class="fu">greedy_couples</span>(</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    large_left, large_right,</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>),</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    <span class="at">strategy =</span> <span class="st">&quot;row_best&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  )</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>})</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Greedy matching (n=500):&quot;</span>, <span class="fu">round</span>(time_greedy[<span class="st">&quot;elapsed&quot;</span>], <span class="dv">2</span>), <span class="st">&quot;seconds</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; Greedy matching (n=500): 0.38 seconds</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Quality (mean distance):&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(result_greedy<span class="sc">$</span>pairs<span class="sc">$</span>distance), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; Quality (mean distance): 0.2886</span></span></code></pre></div>
<p><strong>2. Use blocking to divide the problem:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Create clusters to match within</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">matchmaker</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  large_left, large_right,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="at">block_type =</span> <span class="st">&quot;cluster&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="at">block_vars =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="at">n_blocks =</span> <span class="dv">10</span>  <span class="co"># 10 blocks of ~200 each</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># Match within blocks (10 x O(200^3) &lt;&lt; O(2000^3))</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>result_blocked <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  blocks<span class="sc">$</span>left, blocks<span class="sc">$</span>right,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>),</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  <span class="at">block_id =</span> <span class="st">&quot;block_id&quot;</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>3. Choose a faster algorithm:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># For n &gt; 1000, auction algorithm often faster</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  large_left, large_right,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;auction&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># For sparse problems (many forbidden pairs)</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  left, right,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="at">vars =</span> vars,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="at">max_distance =</span> <span class="fl">0.5</span>,  <span class="co"># Creates sparsity</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;sap&quot;</span>       <span class="co"># Sparse algorithm</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>4. Pre-compute and cache distances:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Compute once, reuse multiple times</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>dist_cache <span class="ot">&lt;-</span> <span class="fu">compute_distances</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  large_left, large_right,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">scale =</span> <span class="st">&quot;robust&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co"># Fast: reuse cached distances</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(dist_cache, <span class="at">max_distance =</span> <span class="fl">0.3</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Error in `lap_solve_auction_scaled()`:</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; ! Auction(scaled): iteration guard at eps=7885383213142811494408480082840444688844086424042268422604802684204020084804602286084062426808668246202024044680060000888826240426666820268808860060886662888880668826624624282408686624866884640486622460688806226620844868208208262004280626244240268286668462608648088464686088602226464888282882.000000, phase=19</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(dist_cache, <span class="at">max_distance =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Error in `lap_solve_auction_scaled()`:</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; ! Auction(scaled): iteration guard at eps=7885383213142811494408480082840444688844086424042268422604802684204020084804602286084062426808668246202024044680060000888826240426666820268808860060886662888880668826624624282408686624866884640486622460688806226620844868208208262004280626244240268286668462608648088464686088602226464888282882.000000, phase=19</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>result3 <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(dist_cache, <span class="at">max_distance =</span> <span class="fl">1.0</span>)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; Error in `lap_solve_auction_scaled()`:</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; ! Auction(scaled): iteration guard at eps=1126483316163258824588840464686822002040606866822442644006464204284244600860220408644206628884660088462204820084486686828448800068422244884462088864286246088448668606428686082644420022446608028628488602664280848840444608420828066682648826868226802866640024264200844882840648848844628646628040.000000, phase=20</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="memory-errors" class="section level2">
<h2>Memory Errors</h2>
<div id="symptom-3" class="section level3">
<h3>Symptom</h3>
<p>R crashes or shows: “Error: cannot allocate vector of size X GB”</p>
</div>
<div id="cause-2" class="section level3">
<h3>Cause</h3>
<p>A full distance matrix for n×n requires 8n² bytes:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Memory requirements</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>memory_needed <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  bytes <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="sc">*</span> n<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="cf">if</span> (bytes <span class="sc">&lt;</span> <span class="fl">1e6</span>) {</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.1f KB&quot;</span>, bytes <span class="sc">/</span> <span class="fl">1e3</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (bytes <span class="sc">&lt;</span> <span class="fl">1e9</span>) {</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.1f MB&quot;</span>, bytes <span class="sc">/</span> <span class="fl">1e6</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%.1f GB&quot;</span>, bytes <span class="sc">/</span> <span class="fl">1e9</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  }</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>}</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Memory for full distance matrix:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; Memory for full distance matrix:</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">20000</span>, <span class="dv">50000</span>)) {</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;  n = %5d: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, n, <span class="fu">memory_needed</span>(n)))</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>}</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;   n =  1000: 8.0 MB</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt;   n =  5000: 200.0 MB</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt;   n = 10000: 800.0 MB</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt;   n = 20000: 3.2 GB</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;   n = 50000: 20.0 GB</span></span></code></pre></div>
</div>
<div id="solutions-3" class="section level3">
<h3>Solutions</h3>
<p><strong>1. Use greedy matching (avoids full matrix):</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Greedy computes distances on-the-fly</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">greedy_couples</span>(</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  left, right,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">vars =</span> covariates,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="at">strategy =</span> <span class="st">&quot;row_best&quot;</span>  <span class="co"># Most memory-efficient</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>2. Use blocking to create smaller subproblems:</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Each block is much smaller</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">matchmaker</span>(left, right, <span class="at">block_type =</span> <span class="st">&quot;cluster&quot;</span>, <span class="at">n_blocks =</span> <span class="dv">20</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(blocks<span class="sc">$</span>left, blocks<span class="sc">$</span>right, <span class="at">vars =</span> vars, <span class="at">block_id =</span> <span class="st">&quot;block_id&quot;</span>)</span></code></pre></div>
<p><strong>3. Use caliper to create sparse matrix:</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Caliper excludes distant pairs (sparse representation)</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  left, right,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="at">vars =</span> covariates,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="at">max_distance =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;sap&quot;</span>  <span class="co"># Sparse-optimized algorithm</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>4. Increase R’s memory limit (Windows):</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Increase to 16 GB (if available)</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">memory.limit</span>(<span class="at">size =</span> <span class="dv">16000</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="different-results-with-different-methods" class="section level2">
<h2>Different Results with Different Methods</h2>
<div id="symptom-4" class="section level3">
<h3>Symptom</h3>
<p>Different algorithms return different assignments:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>result_jv <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost, <span class="at">method =</span> <span class="st">&quot;jv&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>result_hungarian <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost, <span class="at">method =</span> <span class="st">&quot;hungarian&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;JV assignment:       &quot;</span>, result_jv<span class="sc">$</span>target, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; JV assignment:        1 2 3</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hungarian assignment:&quot;</span>, result_hungarian<span class="sc">$</span>target, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Hungarian assignment: 1 2 3</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;JV total cost:       &quot;</span>, <span class="fu">get_total_cost</span>(result_jv), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; JV total cost:        3</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hungarian total cost:&quot;</span>, <span class="fu">get_total_cost</span>(result_hungarian), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; Hungarian total cost: 3</span></span></code></pre></div>
</div>
<div id="cause-3" class="section level3">
<h3>Cause</h3>
<p>When multiple optimal solutions exist (tied costs), different
algorithms may find different ones. <strong>The total cost should be the
same</strong>; if not, report a bug.</p>
</div>
<div id="diagnosis-2" class="section level3">
<h3>Diagnosis</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Check for ties</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>check_ties <span class="ot">&lt;-</span> <span class="cf">function</span>(cost_matrix) {</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cost_matrix)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="co"># Check if diagonal dominates (trivial ties)</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  diag_costs <span class="ot">&lt;-</span> <span class="fu">diag</span>(cost_matrix)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(diag_costs)) <span class="sc">&lt;</span> n) {</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Tied costs on diagonal - multiple optima likely</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  }</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  <span class="co"># Check cost uniqueness</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>  unique_costs <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(cost_matrix)))</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  total_entries <span class="ot">&lt;-</span> <span class="fu">length</span>(cost_matrix)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>  <span class="cf">if</span> (unique_costs <span class="sc">&lt;</span> total_entries <span class="sc">*</span> <span class="fl">0.5</span>) {</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Many repeated costs - ties possible</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  }</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>}</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="fu">check_ties</span>(cost)</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; Tied costs on diagonal - multiple optima likely</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt; Many repeated costs - ties possible</span></span></code></pre></div>
</div>
<div id="solutions-4" class="section level3">
<h3>Solutions</h3>
<p><strong>1. Verify total costs match:</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Total cost should be identical</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">get_total_cost</span>(result_jv) <span class="sc">==</span> <span class="fu">get_total_cost</span>(result_hungarian))</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Both methods found optimal solutions (same total cost)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; Both methods found optimal solutions (same total cost)</span></span></code></pre></div>
<p><strong>2. Use Hungarian for deterministic tie-breaking:</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Hungarian has consistent tie-breaking</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost, <span class="at">method =</span> <span class="st">&quot;hungarian&quot;</span>)</span></code></pre></div>
<p><strong>3. Add small noise to break ties:</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>cost_perturbed <span class="ot">&lt;-</span> cost <span class="sc">+</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">9</span>, <span class="dv">0</span>, <span class="fl">1e-10</span>), <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost_perturbed)</span></code></pre></div>
<hr />
</div>
</div>
<div id="missing-values-in-data" class="section level2">
<h2>Missing Values in Data</h2>
<div id="symptom-5" class="section level3">
<h3>Symptom</h3>
<p>Matching fails or produces unexpected results due to NA values.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="cn">NA</span>, <span class="dv">35</span>, <span class="dv">40</span>))</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">36</span>, <span class="dv">42</span>))</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># This may fail or give unexpected results</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(left, right, <span class="at">vars =</span> <span class="st">&quot;age&quot;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; Error:</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt; ! Missing values (NA) not allowed in matching variables</span></span></code></pre></div>
</div>
<div id="cause-4" class="section level3">
<h3>Cause</h3>
<p>couplr requires complete cases for distance computation. NA values in
matching variables cause issues.</p>
</div>
<div id="solutions-5" class="section level3">
<h3>Solutions</h3>
<p><strong>1. Remove rows with NA (before matching):</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>left_clean <span class="ot">&lt;-</span> left <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age))</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>right_clean <span class="ot">&lt;-</span> right <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age))</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(left_clean, right_clean, <span class="at">vars =</span> <span class="st">&quot;age&quot;</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Matched&quot;</span>, result<span class="sc">$</span>info<span class="sc">$</span>n_matched, <span class="st">&quot;pairs (excluded 1 left unit with NA)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt; Matched 4 pairs (excluded 1 left unit with NA)</span></span></code></pre></div>
<p><strong>2. Impute missing values:</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Simple mean imputation</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>left_imputed <span class="ot">&lt;-</span> left <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(age), <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), age))</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(left_imputed, right, <span class="at">vars =</span> <span class="st">&quot;age&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Matched&quot;</span>, result<span class="sc">$</span>info<span class="sc">$</span>n_matched, <span class="st">&quot;pairs (imputed 1 NA with mean)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co">#&gt; Matched 5 pairs (imputed 1 NA with mean)</span></span></code></pre></div>
<p><strong>3. Use preprocessing to diagnose:</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>health <span class="ot">&lt;-</span> <span class="fu">preprocess_matching_vars</span>(</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  left, right,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="at">vars =</span> <span class="st">&quot;age&quot;</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">print</span>(health)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co">#&gt; Preprocessing Result</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt; ====================</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; Variables: 1</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt; Scaling method: none</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="installation-issues" class="section level2">
<h2>Installation Issues</h2>
<div id="c-compilation-errors" class="section level3">
<h3>C++ Compilation Errors</h3>
<div id="symptom-6" class="section level4">
<h4>Symptom</h4>
<pre><code>Error in .Call(&quot;_couplr_assignment_impl&quot;): object not found</code></pre>
<p>or</p>
<pre><code>Error: package &#39;couplr&#39; was built under R version X.X</code></pre>
</div>
<div id="cause-5" class="section level4">
<h4>Cause</h4>
<p>C++ code not compiled properly, or object files are stale.</p>
</div>
<div id="solutions-6" class="section level4">
<h4>Solutions</h4>
<p><strong>1. Clean and reinstall:</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># In R:</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">remove.packages</span>(<span class="st">&quot;couplr&quot;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;couplr&quot;</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co"># Or from GitHub:</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;gcol33/couplr&quot;</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><strong>2. Clean compiled files (development):</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># PowerShell</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">Remove-Item</span> src\<span class="op">*.</span><span class="fu">o</span><span class="op">,</span> src\<span class="op">*.</span><span class="fu">dll</span> <span class="op">-</span>Force</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># Bash</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">rm</span> src/<span class="pp">*</span>.o src/<span class="pp">*</span>.so</span></code></pre></div>
<p>Then rebuild:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">clean_dll</span>()</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>()</span></code></pre></div>
<p><strong>3. Check Rtools/compiler (Windows):</strong></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Check if Rtools is properly configured</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">&quot;make&quot;</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="co">#&gt;                               make </span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co">#&gt; &quot;C:\\rtools45\\usr\\bin\\make.exe&quot;</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="fu">Sys.which</span>(<span class="st">&quot;g++&quot;</span>)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="co">#&gt;                                          g++ </span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="co">#&gt; &quot;C:\\rtools45\\X86_64~1.POS\\bin\\G__~1.EXE&quot;</span></span></code></pre></div>
<p>Make sure Rtools is installed and PATH is configured correctly.</p>
<hr />
</div>
</div>
</div>
<div id="common-error-messages" class="section level2">
<h2>Common Error Messages</h2>
<div id="method_used-attribute-is-null" class="section level3">
<h3>“method_used attribute is NULL”</h3>
<p><strong>Cause</strong>: Result object wasn’t created properly.</p>
<p><strong>Solution</strong>: Use <code>lap_solve()</code> instead of
<code>assignment()</code> for the tidy interface.</p>
</div>
<div id="cost-matrix-contains-non-finite-values" class="section level3">
<h3>“Cost matrix contains non-finite values”</h3>
<p><strong>Cause</strong>: NA or NaN values in cost matrix (not
Inf).</p>
<p><strong>Solution</strong>: Replace NA with Inf for forbidden
assignments, or remove rows/cols.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>cost[<span class="fu">is.na</span>(cost)] <span class="ot">&lt;-</span> <span class="cn">Inf</span>  <span class="co"># Mark as forbidden</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lap_solve</span>(cost)</span></code></pre></div>
</div>
<div id="all-rows-assigned-to-inf-columns" class="section level3">
<h3>“All rows assigned to Inf columns”</h3>
<p><strong>Cause</strong>: Caliper is too strict; all potential matches
exceed threshold.</p>
<p><strong>Solution</strong>: Increase <code>max_distance</code> or
check for overlap issues.</p>
</div>
<div id="subscript-out-of-bounds" class="section level3">
<h3>“subscript out of bounds”</h3>
<p><strong>Cause</strong>: Empty left or right data frame, or ID
mismatch.</p>
<p><strong>Solution</strong>: Check data dimensions and ID column
consistency.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Always verify data before matching</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">nrow</span>(left) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">nrow</span>(right) <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="getting-help" class="section level2">
<h2>Getting Help</h2>
<p>If you encounter an issue not covered here:</p>
<ol style="list-style-type: decimal">
<li><strong>Check function documentation</strong>:
<code>?match_couples</code>, <code>?lap_solve</code></li>
<li><strong>Search GitHub issues</strong>: <a href="https://github.com/gcol33/couplr/issues">github.com/gcol33/couplr/issues</a></li>
<li><strong>Create a minimal reproducible example</strong>:</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># Minimal example template</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">library</span>(couplr)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># Minimal data that reproduces the issue</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a><span class="co"># Code that causes the error</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(left, right, <span class="at">vars =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a><span class="co"># Expected vs actual behavior</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="co"># Expected: ...</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="co"># Actual: [error message]</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="co"># Session info</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>Open an issue</strong> with your example at <a href="https://github.com/gcol33/couplr/issues/new">github.com/gcol33/couplr/issues/new</a></li>
</ol>
<hr />
</div>
<div id="see-also" class="section level2">
<h2>See Also</h2>
<ul>
<li><code>vignette(&quot;getting-started&quot;)</code> - Basic usage</li>
<li><code>vignette(&quot;matching-workflows&quot;)</code> - Production matching
pipelines</li>
<li><code>vignette(&quot;algorithms&quot;)</code> - Algorithm selection guide</li>
<li><code>vignette(&quot;comparison&quot;)</code> - Comparison with other
packages</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
